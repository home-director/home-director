'use strict';

const fetch = require('node-fetch');

const decodeResponse = function(res) {
  return res.json()
    .then((decoded) => {
      return decoded;
    });
};

const handleError = function(res) {
  console.log('ERROR: ' + res);
};

const SmartThings = function(apiEndpoint) {
  let smartthings = Object.create(SmartThings.prototype);
  smartthings.apiEndpoint = apiEndpoint;
  return smartthings;
};

SmartThings.prototype.getDevices = function() {
  return fetch(this.apiEndpoint)
    .then(decodeResponse)
    .catch(handleError);
};

module.exports = SmartThings;
